# -*- coding:utf-8 -*-
import gmpy2
import sys
from Crypto.Util.number import long_to_bytes

q = 0
p = 0
c = 112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344

flag = 0
N = []

N1 = 331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004
N2 = 302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114
N3 = 332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323

N.append(N1)
N.append(N2)
N.append(N3)

for i in range(2):
    for j in range(i+1, 3):
        if gmpy2.gcd(N[i], N[j]) != 1:
            q = gmpy2.gcd(N[i], N[j])
            p = N[j]/q
            flag = j
            break
    if flag:
        break

ol = (q - 1) * (p - 1)

e = 65537
while True:
    e += 1
    if gmpy2.gcd(e, ol) == 1 and gmpy2.is_prime(e):
        d = gmpy2.invert(e, ol)
        m = pow(c, d, N[flag])
        m = long_to_bytes(m)
        print e
        if m.startswith("flag"):
            sys.stdout.write(m)
